<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutoriel Avancé - Bloc &mdash; blockly_tutorial  documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Tutoriel sur les blocs - Comment modifier les blocs avec la boîte à outils et l’espace de travail" href="block_modify_block_fr.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> blockly_tutorial
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Labyrinthe</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="maze_intro_fr.html">Tutoriel exercices labyrinthe - Premiers pas</a></li>
<li class="toctree-l1"><a class="reference internal" href="maze_map_settings_fr.html">Tutoriel exercices labyrinthes - Paramètres de la carte</a></li>
<li class="toctree-l1"><a class="reference internal" href="maze_modify_blocks_fr.html">Tutoriel exercices labyrinthe - Comment modifier les blocs avec la boîte à outils et l’espace de travail</a></li>
</ul>
<p class="caption"><span class="caption-text">Informations génériques</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="blockly_task_creation_fr.html">Comment créer une tâche sur INGInious étape par étape</a></li>
</ul>
<p class="caption"><span class="caption-text">Blocs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="block_intro_fr.html">Tutoriel sur les blocs - Premiers pas</a></li>
<li class="toctree-l1"><a class="reference internal" href="block_modify_block_fr.html">Tutoriel sur les blocs - Comment modifier les blocs avec la boîte à outils et l’espace de travail</a></li>
</ul>
<p class="caption"><span class="caption-text">Blocs avancé</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutoriel Avancé - Bloc</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creation-d-une-tache-blockly-basique">Création d’une tâche Blockly <em>basique</em>.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#personnalisez-votre-tache-comment-creer-la-fonction-somme-en-utilisant-l-interface-graphique">Personnalisez votre tâche : comment créer la fonction somme (en utilisant l’interface graphique)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#personnalisez-votre-tache-creez-la-fonction-somme-a-la-main-en-utilisant-xml">Personnalisez votre tâche : créez la fonction somme à la main (en utilisant xml)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#personnalisez-votre-tache-une-tache-uniquement-espace-de-travail">Personnalisez votre tâche : une tâche uniquement “espace de travail”.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#personnalisez-votre-tache-comment-creer-un-bloc-personnalise-if-else">Personnalisez votre tâche : comment créer un bloc personnalisé (if/else)</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">blockly_tutorial</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Tutoriel Avancé - Bloc</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/block_advanced_fr.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="tutoriel-avance-bloc">
<h1>Tutoriel Avancé - Bloc<a class="headerlink" href="#tutoriel-avance-bloc" title="Permalink to this headline">¶</a></h1>
<div class="section" id="creation-d-une-tache-blockly-basique">
<h2>Création d’une tâche Blockly <em>basique</em>.<a class="headerlink" href="#creation-d-une-tache-blockly-basique" title="Permalink to this headline">¶</a></h2>
<p>Si vous souhaitez configurer la tâche vous-même ou vous plonger plus profondément dans les tâches de type bloc, cette partie du tutoriel est pour vous.</p>
<p>Il y a, tout d’abord, quelques étapes pour configurer une tâche. Ce sont :</p>
<p>TODO mettre le lien vers “comment créer une tâche sur inginious …”</p>
<ol class="arabic simple">
<li>Créer la tâche. Définissez un titre, un contexte, votre nom, les options que vous voulez,… Lorsque vous créez un sous-problème, sélectionnez “blockly” comme “type de tâche”, donnez-lui un ID et n’oubliez pas de sauvegarder en cliquant sur “Enregistrer les modifications”.</li>
<li>Si vous le souhaitez, dans le bouton “Option de l’espace de travail”, définissez le nombre maximum de blocs que l’étudiant peut utiliser pour réaliser la tâche en l’entrant dans le champ “Nombre maximum de blocs” (“Infini” par défaut)</li>
</ol>
<a class="reference internal image-reference" href="_images/number_of_blocks.png"><img alt="_images/number_of_blocks.png" class="align-center" src="_images/number_of_blocks.png" style="width: 75%;" /></a>
<ol class="arabic simple" start="3">
<li>N’oubliez pas de modifier l‘“environnement” en conséquence. Par exemple, dans une tâche blocs, vous choisirez “Conteneur standard (Docker)” pour le “Type d’environnement d’évaluation”. Vous devez également modifier l‘“Environnement d’évaluation” en fonction du langage de programmation que vous utiliserez. Mettez “Default” si vous n’êtes pas sûr.</li>
</ol>
<p>Il y a deux façons de configurer Blockly : soit en utilisant l’interface graphique intégrée, soit en entrant les blocs à la main. Comme la première solution est plus facile à utiliser pour les débutants, nous allons l’explorer en premier. Dans l’onglet “Sous-problèmes”, ouvrez votre tâche et faites défiler vers le bas, cliquez sur “éditer la boîte à outils/espace de travail graphiquement”.</p>
<a class="reference internal image-reference" href="_images/edit_graphically.png"><img alt="_images/edit_graphically.png" class="align-center" src="_images/edit_graphically.png" style="width: 75%;" /></a>
<p>Vous aurez accès à ceci :</p>
<img alt="_images/base.png" class="align-center" src="_images/base.png" />
<p>La partie gauche est l’endroit où vous pouvez configurer l’outil, et la partie droite affiche un aperçu en direct de ce que vous avez fait jusqu’à présent. La partie gauche comporte deux onglets : la boîte à outils et l’espace de travail. La boîte à outils contient l’ensemble des blocs que l’élève peut utiliser pour résoudre la tâche. Pour ajouter des blocs, il suffit de cliquer sur une catégorie et de glisser/déposer le bloc que vous voulez dans l’onglet. Voici un exemple :</p>
<img alt="_images/toolbox.png" class="align-center" src="_images/toolbox.png" />
<p>Si vous voulez supprimer un bloc, il suffit de le faire glisser vers la corbeille en bas à droite. Maintenant, vous pouvez également ajouter des blocs à l’espace de travail de l’élève, qui serviront de base à l’exercice. Il suffit de cliquer sur l’onglet “espace de travail (workspace)” et de glisser/déposer de la même manière que vous l’avez fait avec la boîte à outils (toolbox).</p>
<img alt="_images/workspace.png" class="align-center" src="_images/workspace.png" />
<p>Voyons maintenant un exemple de ce qui peut être fait pour un exercice simple.</p>
</div>
<div class="section" id="personnalisez-votre-tache-comment-creer-la-fonction-somme-en-utilisant-l-interface-graphique">
<h2>Personnalisez votre tâche : comment créer la fonction somme (en utilisant l’interface graphique)<a class="headerlink" href="#personnalisez-votre-tache-comment-creer-la-fonction-somme-en-utilisant-l-interface-graphique" title="Permalink to this headline">¶</a></h2>
<p>Ici, nous sommes dans le cas où nous voulons que l’étudiant crée une fonction, ce qui signifie que nous devons lui fournir la signature de celle-ci dans l’espace de travail. Notre fonction Somme doit prendre deux paramètres, les deux nombres à additionner (appelons-les a et b), et retourner la somme résultante.</p>
<p>Tout d’abord, cliquez sur l’onglet “Workspace” et ouvrez la catégorie “Function”. Parmi les trois blocs, nous avons besoin de la fonction qui renvoie une valeur, qui est le deuxième bloc sur l’image ici.</p>
<img alt="_images/function.png" class="align-center" src="_images/function.png" />
<p>Maintenant, configurez la fonction. Les icônes de la roue nous permettent d’ajouter des paramètres. Il suffit de nommer votre paramètre (<em>x</em> par défaut), puis de connecter le bloc dans le bon espace, comme ceci :</p>
<a class="reference internal image-reference" href="_images/param1.png"><img alt="_images/param1.png" src="_images/param1.png" style="width: 49%;" /></a>
<a class="reference internal image-reference" href="_images/param2.png"><img alt="_images/param2.png" src="_images/param2.png" style="width: 49%;" /></a>
<p>L’icône “<em>?</em>” nous permet de définir une info-bulle (texte qui s’affiche au passage de la souris) en tapant simplement dans le champ :</p>
<img alt="_images/tooltip.png" class="align-center" src="_images/tooltip.png" />
<p>Enfin, nous devons nommer notre fonction, en changeant le <em>to … with</em> en ce que nous voulons, ici, <em>Sum</em> :</p>
<img alt="_images/name.png" class="align-center" src="_images/name.png" />
<p>Maintenant, créons une variable pour contenir le résultat. Cliquez sur la catégorie “Variables” et sélectionnez “créer une variable” (create variable). Saisissez le nom de votre variable, “résultat” par exemple, et elle sera disponible dans la catégorie :</p>
<a class="reference internal image-reference" href="_images/var1.png"><img alt="_images/var1.png" src="_images/var1.png" style="width: 39%;" /></a>
<a class="reference internal image-reference" href="_images/var2.png"><img alt="_images/var2.png" src="_images/var2.png" style="width: 19%;" /></a>
<a class="reference internal image-reference" href="_images/var3.png"><img alt="_images/var3.png" src="_images/var3.png" style="width: 39%;" /></a>
<p>Enfin, sélectionnez le bloc correspondant et branchez-le à l’endroit “retour” (return). Voici notre espace de travail de base terminé, avec l’aperçu :</p>
<img alt="_images/result1.png" class="align-center" src="_images/result1.png" />
<p>Il est maintenant temps de remplir la boîte à outils avec les blocs nécessaires. Cliquez sur l’onglet correspondant, et sélectionnez les blocs que vous voulez pour la tâche. Dans notre cas, nous devons d’abord recréer toutes les variables précédentes, de la même manière que nous l’avons fait pour la variable <em>result</em> (en cliquant sur créer une variable). Voici ce que nous obtenons :</p>
<img alt="_images/toolVar.png" class="align-center" src="_images/toolVar.png" />
<p>Ensuite, nous voulons le bloc <em>set</em>, donc nous le faisons glisser dans la boîte à outils. En utilisant la flèche à côté du nom de la variable, nous pouvons sélectionner la variable que nous voulons par défaut (<em>result</em> dans notre cas) :</p>
<a class="reference internal image-reference" href="_images/pick.png"><img alt="_images/pick.png" src="_images/pick.png" style="width: 49%;" /></a>
<a class="reference internal image-reference" href="_images/toolVar2.png"><img alt="_images/toolVar2.png" src="_images/toolVar2.png" style="width: 49%;" /></a>
<p>Ensuite, nous ajoutons également les deux variables “a” et “b” créées précédemment. Enfin, nous voulons l’opérateur de somme de la catégorie mathématique :</p>
<img alt="_images/math1.png" class="align-center" src="_images/math1.png" />
<p>Et voici le produit final avec l’aperçu :</p>
<img alt="_images/finished.png" class="align-center" src="_images/finished.png" />
<p>Cliquez sur fermer, puis “appliquer les changements”, et vous avez terminé avec la partie interface graphique de la création de la tâche. Vous pouvez maintenant visualiser votre tâche sur INGInious et connecter les blocs, mais il n’y a pas encore de correction ou de feedback. Voici à quoi cela ressemblera pour l’étudiant :</p>
<img alt="_images/studentResult.png" class="align-center" src="_images/studentResult.png" />
<p>Pour le retour, vous devrez créer un <code class="docutils literal notranslate"><span class="pre">run</span></code> et un fichier qui contient la correction de la tâche. Commençons par celui-là, que nous appellerons <code class="docutils literal notranslate"><span class="pre">sum.py</span></code>. Il doit d’abord récupérer le code de l’étudiant avec une instruction comme celle-ci : <code class="docutils literal notranslate"><span class="pre">&#64;&#64;subProblemID&#64;&#64;</span></code>. Ensuite, vous pourrez appeler la fonction créée avec son nom (ici “Sum”), et ensuite exécuter les tests que vous voulez. Pour se conformer au fichier d’exécution habituel d’INGInious, vous devez sortir “True” si les tests réussissent, et un retour suivi de <code class="docutils literal notranslate"><span class="pre">exit()</span></code> en cas d’échec. Le code suivant est un exemple pour notre fonction somme :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>#!/bin/python3
#Open source licence goes here

from contextlib import redirect_stdout
import random

@@Sum@@ #The id of your subproblem goes here

if __name__ == &quot;__main__&quot;:
    random.seed(55)
    for j in range(6): #let&#39;s test 6 times
        a = random.randint(0,10)
        b = random.randint(0,10)
        result = Sum(a, b)
        if(result != (a+b)):
            print(&quot;The sum you returned for the values &quot; + str(a) + &quot; and &quot; + str(b) +
            &quot; is &quot; + str(result) + &quot; when the correct answer is &quot; + str(a+b) + &quot;.&quot;)
            exit()
    print(&quot;True&quot;)
</pre></div>
</div>
<p>Pour une tâche aussi simple, le fichier de base <code class="docutils literal notranslate"><span class="pre">run</span></code> est suffisant, avec seulement deux lignes à modifier, où vous devrez mettre le nom de votre fichier de correction. Voici le code correspondant à notre tâche de somme :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/python3</span>
<span class="c1">#Open source licence goes here</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">shlex</span>
<span class="kn">from</span> <span class="nn">inginious</span> <span class="kn">import</span> <span class="n">feedback</span>
<span class="kn">from</span> <span class="nn">inginious</span> <span class="kn">import</span> <span class="nb">input</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="nb">input</span><span class="o">.</span><span class="n">parse_template</span><span class="p">(</span><span class="s2">&quot;sum.py&quot;</span><span class="p">)</span> <span class="c1">#Replace sum.py by your filename on this line AND the next</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;python3 sum.py&quot;</span><span class="p">),</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
    <span class="n">make_output</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span><span class="p">:</span>
        <span class="n">feedback</span><span class="o">.</span><span class="n">set_global_result</span><span class="p">(</span><span class="s2">&quot;failed&quot;</span><span class="p">)</span>
        <span class="n">feedback</span><span class="o">.</span><span class="n">set_global_feedback</span><span class="p">(</span><span class="s2">&quot;Your code could not be executed. Please verify that all your blocks are correctly connected.&quot;</span><span class="p">)</span>
        <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">make_output</span> <span class="o">==</span> <span class="s2">&quot;True</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
        <span class="n">feedback</span><span class="o">.</span><span class="n">set_global_result</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
        <span class="n">feedback</span><span class="o">.</span><span class="n">set_global_feedback</span><span class="p">(</span><span class="s2">&quot;You solved the task !&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">feedback</span><span class="o">.</span><span class="n">set_global_result</span><span class="p">(</span><span class="s2">&quot;failed&quot;</span><span class="p">)</span>
        <span class="n">feedback</span><span class="o">.</span><span class="n">set_global_feedback</span><span class="p">(</span><span class="s2">&quot;You made a mistake ! &quot;</span> <span class="o">+</span> <span class="n">make_output</span><span class="p">)</span>
</pre></div>
</div>
<p>Ces deux fichiers doivent être placés dans le dossier de votre tâche, et la création de la tâche est terminée !</p>
</div>
<div class="section" id="personnalisez-votre-tache-creez-la-fonction-somme-a-la-main-en-utilisant-xml">
<h2>Personnalisez votre tâche : créez la fonction somme à la main (en utilisant xml)<a class="headerlink" href="#personnalisez-votre-tache-creez-la-fonction-somme-a-la-main-en-utilisant-xml" title="Permalink to this headline">¶</a></h2>
<p>La boîte à outils et l’espace de travail peuvent également être créés à la main (en utilisant du code xml) en cliquant sur les boutons “Edit toolbox XML” et “Edit workspace XML”. Nous allons voir comment configurer ces deux éléments pour obtenir la même configuration que dans l’exemple précédent.</p>
<p>Tout d’abord, des balises xml doivent entourer une ligne sur deux dans la boîte à outils et l’espace de travail, comme ceci :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;xml</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/xml&gt;</span>
</pre></div>
</div>
<p>Ensuite, pour la boîte à outils, nous avons besoin des variables <em>a</em>, <em>b</em> et <em>resultat</em>. Le code pour une variable est le suivant, seul le contenu de la balise <code class="docutils literal notranslate"><span class="pre">field</span></code> change pour indiquer le nom de la variable. Voici le code pour la variable <em>a</em> :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;block</span> <span class="na">type=</span><span class="s">&quot;variables_get&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;VAR&quot;</span><span class="nt">&gt;</span>a<span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/block&gt;</span>
</pre></div>
</div>
<p>Nous avons également besoin du code de bloc de l’opérateur de somme, qui est le suivant :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span>  <span class="nt">&lt;block</span> <span class="na">type=</span><span class="s">&quot;math_arithmetic&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;OP&quot;</span><span class="nt">&gt;</span>ADD<span class="nt">&lt;/field&gt;</span>
  <span class="nt">&lt;value</span> <span class="na">name=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shadow</span> <span class="na">type=</span><span class="s">&quot;math_number&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;NUM&quot;</span><span class="nt">&gt;</span>1<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;/shadow&gt;</span>
  <span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;value</span> <span class="na">name=</span><span class="s">&quot;B&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shadow</span> <span class="na">type=</span><span class="s">&quot;math_number&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;NUM&quot;</span><span class="nt">&gt;</span>1<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;/shadow&gt;</span>
  <span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/block&gt;</span>
</pre></div>
</div>
<p>Chaque bloc aura un code différent, que vous pouvez trouver soit en ligne, soit en utilisant l’interface graphique. Vous pouvez également personnaliser un bloc en modifiant les valeurs (en remplaçant <em>ADD</em> par <em>MINUS</em> dans la balise <code class="docutils literal notranslate"><span class="pre">field</span></code>, vous obtiendrez un bloc d’opérateur moins, par exemple).</p>
<p>Pour récapituler, voici le code complet de la boîte à outils :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;xml</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;block</span> <span class="na">type=</span><span class="s">&quot;math_arithmetic&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;OP&quot;</span><span class="nt">&gt;</span>ADD<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;value</span> <span class="na">name=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;shadow</span> <span class="na">type=</span><span class="s">&quot;math_number&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;NUM&quot;</span><span class="nt">&gt;</span>1<span class="nt">&lt;/field&gt;</span>
      <span class="nt">&lt;/shadow&gt;</span>
    <span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;value</span> <span class="na">name=</span><span class="s">&quot;B&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;shadow</span> <span class="na">type=</span><span class="s">&quot;math_number&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;NUM&quot;</span><span class="nt">&gt;</span>1<span class="nt">&lt;/field&gt;</span>
      <span class="nt">&lt;/shadow&gt;</span>
    <span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;/block&gt;</span>
  <span class="nt">&lt;block</span> <span class="na">type=</span><span class="s">&quot;variables_set&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;VAR&quot;</span><span class="nt">&gt;</span>result<span class="nt">&lt;/field&gt;</span>
  <span class="nt">&lt;/block&gt;</span>
  <span class="nt">&lt;block</span> <span class="na">type=</span><span class="s">&quot;variables_get&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;VAR&quot;</span><span class="nt">&gt;</span>a<span class="nt">&lt;/field&gt;</span>
  <span class="nt">&lt;/block&gt;</span>
  <span class="nt">&lt;block</span> <span class="na">type=</span><span class="s">&quot;variables_get&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;VAR&quot;</span><span class="nt">&gt;</span>b<span class="nt">&lt;/field&gt;</span>
  <span class="nt">&lt;/block&gt;</span>
  <span class="nt">&lt;block</span> <span class="na">type=</span><span class="s">&quot;variables_get&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;VAR&quot;</span><span class="nt">&gt;</span>result<span class="nt">&lt;/field&gt;</span>
  <span class="nt">&lt;/block&gt;</span>
<span class="nt">&lt;/xml&gt;</span>
</pre></div>
</div>
<p>Maintenant, pour l’espace de travail, nous avons à nouveau besoin de notre fonction. Les arguments sont spécifiés dans la balise <code class="docutils literal notranslate"><span class="pre">mutation</span></code>, le nom dans <code class="docutils literal notranslate"><span class="pre">name</span></code> et l’info-bulle dans <code class="docutils literal notranslate"><span class="pre">comment</span></code>. Enfin, notre variable de résultat est spécifiée par une balise spéciale <code class="docutils literal notranslate"><span class="pre">value</span></code>, avec le nom <em>RETURN</em>. Voici le code de l’espace de travail.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;xml</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;block</span> <span class="na">type=</span><span class="s">&quot;procedures_defreturn&quot;</span> <span class="na">deletable=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;mutation&gt;</span>
      <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;a&quot;</span><span class="nt">&gt;&lt;/arg&gt;</span>
      <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;b&quot;</span><span class="nt">&gt;&lt;/arg&gt;</span>
    <span class="nt">&lt;/mutation&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;NAME&quot;</span><span class="nt">&gt;</span>Sum<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;comment</span> <span class="na">pinned=</span><span class="s">&quot;false&quot;</span> <span class="na">h=</span><span class="s">&quot;80&quot;</span> <span class="na">w=</span><span class="s">&quot;160&quot;</span><span class="nt">&gt;</span>Return the sum of values a and b…<span class="nt">&lt;/comment&gt;</span>
    <span class="nt">&lt;value</span> <span class="na">name=</span><span class="s">&quot;RETURN&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;block</span> <span class="na">type=</span><span class="s">&quot;variables_get&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;VAR&quot;</span><span class="nt">&gt;</span>result<span class="nt">&lt;/field&gt;</span>
      <span class="nt">&lt;/block&gt;</span>
    <span class="nt">&lt;/value&gt;</span>
  <span class="nt">&lt;/block&gt;</span>
<span class="nt">&lt;/xml&gt;</span>
</pre></div>
</div>
<p>À ce stade, nous obtenons exactement le même résultat que dans l’exemple précédent. Mais en modifiant la boîte à outils à la main, vous pouvez contrôler plus finement l’affichage final. Par exemple, nous pourrions créer une catégorie <em>Variable</em> et une catégorie <em>Math</em>, ce qui rendrait l’affichage plus léger. Ceci peut être fait avec les balises <code class="docutils literal notranslate"><span class="pre">category</span></code>, comme ceci :</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;xml</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;category</span> <span class="na">name=</span><span class="s">&quot;Math&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;block</span> <span class="na">type=</span><span class="s">&quot;math_arithmetic&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;OP&quot;</span><span class="nt">&gt;</span>ADD<span class="nt">&lt;/field&gt;</span>
      <span class="nt">&lt;value</span> <span class="na">name=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;shadow</span> <span class="na">type=</span><span class="s">&quot;math_number&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;NUM&quot;</span><span class="nt">&gt;</span>1<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/shadow&gt;</span>
      <span class="nt">&lt;/value&gt;</span>
      <span class="nt">&lt;value</span> <span class="na">name=</span><span class="s">&quot;B&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;shadow</span> <span class="na">type=</span><span class="s">&quot;math_number&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;NUM&quot;</span><span class="nt">&gt;</span>1<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/shadow&gt;</span>
      <span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/block&gt;</span>
  <span class="nt">&lt;/category&gt;</span>
  <span class="nt">&lt;category</span> <span class="na">name=</span><span class="s">&quot;Variables&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;block</span> <span class="na">type=</span><span class="s">&quot;variables_set&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;VAR&quot;</span><span class="nt">&gt;</span>result<span class="nt">&lt;/field&gt;</span>
      <span class="nt">&lt;/block&gt;</span>
      <span class="nt">&lt;block</span> <span class="na">type=</span><span class="s">&quot;variables_get&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;VAR&quot;</span><span class="nt">&gt;</span>a<span class="nt">&lt;/field&gt;</span>
      <span class="nt">&lt;/block&gt;</span>
      <span class="nt">&lt;block</span> <span class="na">type=</span><span class="s">&quot;variables_get&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;VAR&quot;</span><span class="nt">&gt;</span>b<span class="nt">&lt;/field&gt;</span>
      <span class="nt">&lt;/block&gt;</span>
      <span class="nt">&lt;block</span> <span class="na">type=</span><span class="s">&quot;variables_get&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;VAR&quot;</span><span class="nt">&gt;</span>result<span class="nt">&lt;/field&gt;</span>
      <span class="nt">&lt;/block&gt;</span>
  <span class="nt">&lt;/category&gt;</span>
<span class="nt">&lt;/xml&gt;</span>
</pre></div>
</div>
<p>Voici le résultat du point de vue de l’étudiant :</p>
<a class="reference internal image-reference" href="_images/cat1.png"><img alt="_images/cat1.png" src="_images/cat1.png" style="width: 49%;" /></a>
<a class="reference internal image-reference" href="_images/cat2.png"><img alt="_images/cat2.png" src="_images/cat2.png" style="width: 49%;" /></a>
<p>Pour obtenir la documentation complète sur ce qui peut être réalisé en modifiant manuellement la boîte à outils, rendez-vous sur <a class="reference external" href="https://developers.google.com/blockly/guides/configure/web/toolbox">ce lien</a> (documentation Google).</p>
</div>
<div class="section" id="personnalisez-votre-tache-une-tache-uniquement-espace-de-travail">
<h2>Personnalisez votre tâche : une tâche uniquement “espace de travail”.<a class="headerlink" href="#personnalisez-votre-tache-une-tache-uniquement-espace-de-travail" title="Permalink to this headline">¶</a></h2>
<p>Lors de la création d’un cours Blockly, vous pouvez souhaiter que vos étudiants ne réorganisent que les blocs qui se trouvent sur l’espace de travail plutôt que d’utiliser une boîte à outils. Cet exemple vous montrera comment réaliser cela avec l’interface graphique. Nous allons prendre l’exemple très simple d’une fonction qui compte le nombre d’occurrences d’un nombre n dans une liste et le renvoie.</p>
<p>Tout d’abord, ouvrez l’éditeur graphique, cliquez sur l’onglet espace de travail et créez une fonction qui prend deux paramètres <em>liste</em> et <em>n</em>, et renvoie une valeur <em>rendement</em> (si vous n’êtes pas familier avec l’utilisation de l’interface graphique, reportez-vous à <a class="reference internal" href="#personnalisez-votre-tache-comment-creer-la-fonction-somme-en-utilisant-l-interface-graphique">Personnalisez votre tâche : comment créer la fonction somme (en utilisant l’interface graphique)</a>)</p>
<img alt="_images/workFun.png" class="align-center" src="_images/workFun.png" />
<p>Ensuite, à partir de la catégorie <em>Variables</em>, prenez le bloc “set result to”, et placez-le comme premier bloc dans le corps de la fonction. Dans la catégorie <em>Math</em>, prenez le bloc “0”, pour mettre le résultat à zéro. Voici la progression actuelle :</p>
<img alt="_images/workSet.png" class="align-center" src="_images/workSet.png" />
<p>Ensuite, dans la catégorie <em>Loops</em>, récupérez le bloc “for each item in list”, branchez-le sous le dernier bloc, et récupérez la variable <em>list</em> pour l’ajouter au bloc :</p>
<img alt="_images/workLoop.png" class="align-center" src="_images/workLoop.png" />
<p>Ajoutez la condition “if” de la catégorie <em>Logic</em>, et créez notre booléen <cite>i == n</cite> avec des blocs de <em>Logique</em> et <em>Variables</em>.</p>
<img alt="_images/workBool.png" class="align-center" src="_images/workBool.png" />
<p>Enfin, récupérez le bloc “change result by” dans les sections <em>Variables</em> et connectez-le au corps du if. Ceci est notre fonction correcte :</p>
<img alt="_images/workFin.png" class="align-center" src="_images/workFin.png" />
<p>Maintenant, nous pouvons ajouter délibérément des problèmes que l’étudiant devra résoudre. Nous pouvons changer le booléen <cite>==</cite> en quelque chose d’autre, ou, dans notre cas, déplacer le bloc “set result to 0” à l’intérieur du corps de la boucle, comme ceci :</p>
<img alt="_images/workFalse.png" class="align-center" src="_images/workFalse.png" />
<p>Voici ce que l’étudiant verra sur INGInious :</p>
<img alt="_images/workStud.png" class="align-center" src="_images/workStud.png" />
<p>Encore une fois, nous devons créer un fichier <cite>run</cite> (le même que le précédent, ne sera pas détaillé ici) et un fichier de correction. Voici le code pour le dernier fichier :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>#!/bin/python3
# Open source licence goes here
from contextlib import redirect_stdout
import random

@@count@@

def countList(List, n):
  res = 0
  for i in List:
    if i == n:
        res += 1
  return res


if __name__ == &quot;__main__&quot;:
    random.seed(55)
    for i in range(6): #6 tests
        List = []
        for j in range(15): #lists of 15 elements
            List.append(random.randint(0,10))
        n = random.randint(0,10)
        correct = countList(List, n)
        output = Count(List, n)
        if(correct != output):
            print(&quot;For the list &quot;+str(List)+ &quot; and the number &quot;+str(n)+ &quot; you have returned &quot;
            + str(output) + &quot; when the correct answer is &quot; + str(correct) + &quot;.&quot;)
            exit()
    print(&quot;True&quot;)
</pre></div>
</div>
<p>Pour faciliter la correction et le retour d’information, nous avons défini une fonction donnant la bonne réponse, et comparé le résultat de cette fonction à celui de l’étudiant. Nous effectuons ensuite quelques tests sur des entrées aléatoires. Avec le fichier d’exécution de base et celui-ci dans le dossier de votre tâche, celle-ci est terminée.</p>
</div>
<div class="section" id="personnalisez-votre-tache-comment-creer-un-bloc-personnalise-if-else">
<h2>Personnalisez votre tâche : comment créer un bloc personnalisé (if/else)<a class="headerlink" href="#personnalisez-votre-tache-comment-creer-un-bloc-personnalise-if-else" title="Permalink to this headline">¶</a></h2>
<p>Si vous pensez que les blocs existants ne fournissent pas assez de fonctionnalités, vous pouvez créer les vôtres et les exporter. Pour ce faire, rendez-vous sur <a class="reference external" href="https://blockly-demo.appspot.com/static/demos/blockfactory/index.html">ce lien</a>, qui est une usine vous permettant de créer de nouveaux blocs en utilisant Blockly lui-même. Voici le premier écran :</p>
<img alt="_images/baseScreen.png" class="align-center" src="_images/baseScreen.png" />
<p>Vous construirez votre bloc en utilisant le côté gauche, tandis que le côté droit est un aperçu en direct du visuel et du code qui seront générés. Construisons un bloc <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">else</span></code>. Tout d’abord, saisissez un nom dans le champ supérieur. Il doit être unique pour tous les blocs Blockly, nous l’appellerons donc <code class="docutils literal notranslate"><span class="pre">custom_if_else</span></code>. Ensuite, nous pouvons définir une info-bulle dans le champ correspondant, et choisir une couleur pour le bloc en utilisant le bloc <code class="docutils literal notranslate"><span class="pre">hue</span></code> (la couleur ne changera pas le comportement).</p>
<img alt="_images/blockCustom1.png" class="align-center" src="_images/blockCustom1.png" />
<p>Nous allons maintenant construire les slots dont notre nouveau bloc a besoin. Puisque nous faisons un <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">else</span></code>, nous devons attacher une condition booléenne (la condition if), et deux slots pour mettre des déclarations. Ceci peut être fait avec la catégorie <em>Input</em> de la factory. Il y a trois types d’entrées : value, statement et dummy.</p>
<p>L’entrée valeur crée des emplacements à droite du bloc pour y insérer des blocs qui renvoient une valeur, c’est ce dont nous avons besoin pour notre condition. Chaque entrée doit avoir un nom unique dans le bloc et un type accepté. Dans notre cas, nous nommons l’entrée “COND” (les majuscules sont une convention mais ne sont pas obligatoires), et nous définissons le type à <em>booléen</em> en utilisant le bloc dans la catégorie <em>Type</em>.</p>
<img alt="_images/blockCustom2.png" class="align-center" src="_images/blockCustom2.png" />
<p>Maintenant, nous avons besoin des emplacements pour mettre les déclarations. Encore une fois, cliquez sur la catégorie <em>Input</em> et faites glisser deux blocs <em>statements</em> (les entrées factices ne seront pas utilisées dans ce tutoriel, elles permettent simplement d’ajouter de l’espace supplémentaire à un bloc pour les annotations mais ne sont pas interactives). Nous devons nommer ces entrées, respectivement “IF_STAT” et “ELSE_STAT”.</p>
<img alt="_images/blockCustom3.png" class="align-center" src="_images/blockCustom3.png" />
<p>Maintenant, notre bloc a la structure correcte, mais l’ajout de texte le rendrait plus clair. Cela peut être fait en utilisant la catégorie <em>Field</em>. Il y a beaucoup d’éléments de champs différents (entrée utilisateur, drop down, sélecteurs de couleurs,…), pour lesquels vous pouvez trouver de la documentation <a class="reference external" href="https://developers.google.com/blockly/guides/create-custom-blocks/blockly-developer-tools">ici</a>.</p>
<p>Dans notre cas, nous avons besoin de deux champs <em>text</em>, un dans la saisie de la valeur, et un dans la saisie de la deuxième déclaration. Dans le premier champ, nous écrivons <code class="docutils literal notranslate"><span class="pre">if</span></code>, et dans le second <code class="docutils literal notranslate"><span class="pre">else</span></code> (ici, il n’y a pas besoin que les valeurs soient uniques).</p>
<img alt="_images/blockCustom4.png" class="align-center" src="_images/blockCustom4.png" />
<p>Enfin, nous devons définir la manière dont notre bloc interagit avec les autres en utilisant la liste déroulante des connexions. Actuellement, <em>aucune connexion</em> est sélectionné, ce qui signifie que nous ne pouvons pas brancher le bloc à quoi que ce soit (c’est l’option correcte pour un corps de fonction par exemple). Nous devons être en mesure de le brancher dans un bloc et de brancher des blocs après lui, donc nous choisissons <em>connexions supérieures + inférieures</em>, et voici notre bloc fait :</p>
<img alt="_images/blockCustom5.png" class="align-center" src="_images/blockCustom5.png" />
<p>Maintenant, nous devons l’exporter. Tout d’abord, cliquez sur le bouton vert <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">&quot;custom_if_else&quot;</span></code>. Ensuite, cliquez sur l’onglet “Block Exporter” :</p>
<img alt="_images/blockCustom6.png" class="align-center" src="_images/blockCustom6.png" />
<p>Cochez la case à côté du nom de notre bloc (cela vous permet d’exporter plusieurs blocs à la fois). Pour le générateur, nous avons besoin de la version Python du code, donc changez la langue en utilisant la liste déroulante. Pour la définition, Javascript ou JSON fonctionne, il faut juste l’intégrer différemment. Choisissez les noms de fichiers (ici, <em>custom.json</em> et <em>custom.js</em>), puis cliquez sur “Exporter” :</p>
<img alt="_images/blockCustom7.png" class="align-center" src="_images/blockCustom7.png" />
<p>Enregistrez les deux fichiers et vous pouvez fermer l’onglet, nous ne l’utiliserons plus. Pour faire plus simple, INGInious n’utilise qu’un seul fichier pour définir tous les blocs personnalisés, nous devrons donc copier le code que nous avons téléchargé. Voici la structure générale du fichier que nous allons créer :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">//License</span>
<span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="nx">Blockly</span><span class="p">.</span><span class="nx">Blocks</span><span class="p">[</span><span class="s1">&#39;block_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">//JSON or javascript code for the bloc</span>
<span class="p">};</span>

<span class="nx">Blockly</span><span class="p">.</span><span class="nx">Python</span><span class="p">[</span><span class="s1">&#39;block_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">block</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">//Generated code for the block</span>
  <span class="c1">//Custom code to represent the block</span>
  <span class="k">return</span> <span class="nx">code</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Pour la première fonction, qui est la description du bloc, vous pouvez utiliser le code javascript tel qu’il a été généré, ou mettre le JSON dans ce format :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span> <span class="nx">Blockly</span><span class="p">.</span><span class="nx">Blocks</span><span class="p">[</span><span class="s1">&#39;block_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">jsonInit</span><span class="p">({</span>
      <span class="c1">//JSON code for the block</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Dans ce cas, n’oubliez pas de supprimer les <strong>[{}]</strong> supplémentaires qui entourent la description json, comme le montre le bout de code suivant. En utilisant nos fichiers générés, nous obtenons :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">//License</span>
<span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="nx">Blockly</span><span class="p">.</span><span class="nx">Blocks</span><span class="p">[</span><span class="s1">&#39;block_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">jsonInit</span><span class="p">({</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;custom_if_else&quot;</span><span class="p">,</span>
      <span class="s2">&quot;message0&quot;</span><span class="o">:</span> <span class="s2">&quot;if %1 %2 else %3&quot;</span><span class="p">,</span>
      <span class="s2">&quot;args0&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;input_value&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;COND&quot;</span><span class="p">,</span>
          <span class="s2">&quot;check&quot;</span><span class="o">:</span> <span class="s2">&quot;Boolean&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;input_statement&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;IF_STAT&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;input_statement&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;ELSE_STAT&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;previousStatement&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
      <span class="s2">&quot;nextStatement&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
      <span class="s2">&quot;colour&quot;</span><span class="o">:</span> <span class="mi">285</span><span class="p">,</span>
      <span class="s2">&quot;tooltip&quot;</span><span class="o">:</span> <span class="s2">&quot;if COND is true, execute the first block. Otherwise, execute the second&quot;</span><span class="p">,</span>
      <span class="s2">&quot;helpUrl&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">Blockly</span><span class="p">.</span><span class="nx">Python</span><span class="p">[</span><span class="s1">&#39;block_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">block</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">value_cond</span> <span class="o">=</span> <span class="nx">Blockly</span><span class="p">.</span><span class="nx">Python</span><span class="p">.</span><span class="nx">valueToCode</span><span class="p">(</span><span class="nx">block</span><span class="p">,</span> <span class="s1">&#39;COND&#39;</span><span class="p">,</span> <span class="nx">Blockly</span><span class="p">.</span><span class="nx">Python</span><span class="p">.</span><span class="nx">ORDER_ATOMIC</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">statements_if_stat</span> <span class="o">=</span> <span class="nx">Blockly</span><span class="p">.</span><span class="nx">Python</span><span class="p">.</span><span class="nx">statementToCode</span><span class="p">(</span><span class="nx">block</span><span class="p">,</span> <span class="s1">&#39;IF_STAT&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">statements_else_stat</span> <span class="o">=</span> <span class="nx">Blockly</span><span class="p">.</span><span class="nx">Python</span><span class="p">.</span><span class="nx">statementToCode</span><span class="p">(</span><span class="nx">block</span><span class="p">,</span> <span class="s1">&#39;ELSE_STAT&#39;</span><span class="p">);</span>
  <span class="c1">// TODO: Assemble Python into code variable.</span>
  <span class="kd">var</span> <span class="nx">code</span> <span class="o">=</span> <span class="s1">&#39;...\n&#39;</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">code</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Maintenant, il ne nous reste plus qu’à lier toutes les parties de notre bloc dans le code python correspondant. Plus de détails sur la façon d’extraire le code d’un bloc peuvent être trouvés sur <a class="reference external" href="https://developers.google.com/blockly/guides/create-custom-blocks/generating-code">ce lien</a>. Ici, nous devons simplement écrire la structure if/else autour de la partie que nous avons déjà obtenue dans les variables et la mettre dans une chaîne :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">Blockly</span><span class="p">.</span><span class="nx">Python</span><span class="p">[</span><span class="s1">&#39;block_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">block</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">value_cond</span> <span class="o">=</span> <span class="nx">Blockly</span><span class="p">.</span><span class="nx">Python</span><span class="p">.</span><span class="nx">valueToCode</span><span class="p">(</span><span class="nx">block</span><span class="p">,</span> <span class="s1">&#39;COND&#39;</span><span class="p">,</span> <span class="nx">Blockly</span><span class="p">.</span><span class="nx">Python</span><span class="p">.</span><span class="nx">ORDER_ATOMIC</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">statements_if_stat</span> <span class="o">=</span> <span class="nx">Blockly</span><span class="p">.</span><span class="nx">Python</span><span class="p">.</span><span class="nx">statementToCode</span><span class="p">(</span><span class="nx">block</span><span class="p">,</span> <span class="s1">&#39;IF_STAT&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">statements_else_stat</span> <span class="o">=</span> <span class="nx">Blockly</span><span class="p">.</span><span class="nx">Python</span><span class="p">.</span><span class="nx">statementToCode</span><span class="p">(</span><span class="nx">block</span><span class="p">,</span> <span class="s1">&#39;ELSE_STAT&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">code</span> <span class="o">=</span> <span class="s1">&#39;if &#39;</span><span class="o">+</span><span class="nx">value_cond</span><span class="o">+</span><span class="s2">&quot; :\n&quot;</span><span class="o">+</span><span class="nx">statements_if_stat</span><span class="o">+</span><span class="s2">&quot; \nelse:\n&quot;</span><span class="o">+</span><span class="nx">statements_else_stat</span><span class="o">+</span><span class="s2">&quot;\n&quot;</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">code</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Maintenant, nous allons enregistrer tout cela dans un fichier, <em>custom_block.js</em>, et nous diriger vers INGInious. Tout d’abord, créez une nouvelle tâche et un sous-problème Blockly, puis si vous n’avez pas encore de répertoire public, créez-en un. Copiez ensuite votre fichier dans ce répertoire public dans votre tâche (<code class="docutils literal notranslate"><span class="pre">nom</span> <span class="pre">de</span> <span class="pre">la</span> <span class="pre">tâche/public</span></code>), si votre fichier n’est pas dans le répertoire “public”, le chemin ne fonctionnera pas. Rafraîchissez (F5) la page d’édition de la tâche pour voir votre fichier. Ensuite, sur le sous-problème correspondant, ajoutez le nom de votre fichier comme “Fichier de bloc supplémentaire” en cliquant sur le bouton bleu et en tapant le nom du fichier.</p>
<img alt="_images/blockCustom8.png" class="align-center" src="_images/blockCustom8.png" />
<p>Cliquez sur “Enregistrer les modifications” (en haut ou en bas de la page), puis actualisez à nouveau. Maintenant, vous pouvez utiliser votre bloc comme n’importe quel autre bloc dans votre tâche, en le trouvant dans la catégorie <em>Bibliothèque de blocs</em> lorsque vous utilisez l’interface graphique :</p>
<img alt="_images/blockCustom9.png" class="align-center" src="_images/blockCustom9.png" />
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="block_modify_block_fr.html" class="btn btn-neutral float-left" title="Tutoriel sur les blocs - Comment modifier les blocs avec la boîte à outils et l’espace de travail" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, celine deknop - cyrille debongnie.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>